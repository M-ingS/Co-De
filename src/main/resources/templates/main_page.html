<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main</title>
    <link rel="stylesheet" href="/css/main_page2.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com"> <!--  <p> Ìè∞Ìä∏ Ï†ÅÏö© -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <!--  <p> Ìè∞Ìä∏ Ï†ÅÏö© -->
    <link href="https://fonts.googleapis.com/css2?family=Play:wght@700&display=swap" rel="stylesheet">
    <!--  <p> Ìè∞Ìä∏ Ï†ÅÏö© -->
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Play:wght@700&display=swap"
          rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Play:wght@700&display=swap"
          rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Play:wght@700&display=swap"
          rel="stylesheet">

    <!-- Îã§Ïùå Ï£ºÏÜå Ï∞æÍ∏∞ API -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
            crossorigin="anonymous"></script>
</head>

<body>
<div class="main">
    <div class="topper">
        <!-- Î°úÍ∑∏Ïù∏ Î∂ÄÎ∂Ñ -->
        <div class="login">
            <a href="#" class="v-bar" style="color: #8E8E8E">ÎèÑÏõÄÎßê</a>
            <a href="#" class="v-bar" style="color: #8E8E8E">Ïù¥Î≤§Ìä∏</a>
            <a href="/logout" class="logout" style="color: #8E8E8E">Î°úÍ∑∏ÏïÑÏõÉ</a>
        </div>
    </div>
    <!-- Ìó§Îçî Î∂ÄÎ∂Ñ -->
    <div class="header">
        <!-- CO-ORDER Ï†úÎ™© Î∂ÄÎ∂Ñ -->
        <div class="width-container">
            <div class="logo-img">
                <!--            <a href="Î©îÏù∏ÌôîÎ©¥ ÎßÅÌÅ¨" style="color: #7CAB75">CO-OR</a>-->
                <img class="logo" src="images/COOR2.png">
            </div>
            <div id="header-bell" class="header-bell" style="cursor:pointer;">
                    <span class="bell">
                        <img src="images/bell.png" style="width : 25px; height : 25px;" alt="">
                    </span>
            </div>
            <div id="header-profile" class="header-profile">
                <a class="header-user">
                        <span class="user-picture">
                            <img src="images/profile.png" height="50px" width="50px">
                        </span>
                    <span class="user-name" th:text="${nickname}">
                        </span>
                    <span class="header-arrow">
                            <img src="https://buts.co.kr/thema/Buts/colorset/Basic/img/mymenu-arrow.png" alt="">
                        </span>
                </a>
                <div id="layer-header-profile" class="layer-header-profile" style="display : none;">
                    <div class="block block-name">
                        <div class="profile-name" th:text="${nickname}">
                        </div>
                        <div class="buttons">
                            <a href="#">ÌååÌã∞Í¥ÄÎ¶¨</a>
                        </div>
                    </div>
                    <!--                    <div class="header-profile-direct">-->
                    <!--                        <dl class="header-member-direct__information">-->
                    <!--                            <div class="profile-nickname" th:text="${nickname}"></div>-->
                    <!--                            <input type="button" id="profile_btn_btn" onclick="myPage()" value="ÎßàÏù¥ÌéòÏù¥ÏßÄ"></input>-->
                    <!--                            <dd>„Öá„Öá</dd>-->
                    <!--                            <dd>„Öá„Öá</dd>-->
                    <!--                        </dl>-->
                    <!--                    </div>-->
                </div>
            </div>
        </div>
        <!-- Ï£ºÏÜå ÏûÖÎ†• Î∂ÄÎ∂Ñ -->
        <div class="search-container">
            <div class="search">
                <button id="loc_btn" type="button" name="loc_btn" onclick="getCurrentPosition()">
                    <img class="gps" src="images/search.png">
                </button>
                <input id="search_input" type="text" name="address" required placeholder="Î™®ÏßëÍ∏Ä Í≤ÄÏÉâÏùÑ ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî!">
                <div class="tag-container">
                    <div class="tag real-time-text">
                        <p class="search-tag-text">Ïã§ÏãúÍ∞Ñ Í≤ÄÏÉâ ÌÉúÍ∑∏</p>
                    </div>
                    <div class="tag real-time">
                        #ÏπòÌÇ® &nbsp;&nbsp;#Ìè¨ÏºÄ &nbsp;&nbsp;#ÎßàÎùºÌÉï
                    </div>
                </div>
            </div>
            <ul>
                <li class="menu-li">
                    <a class="menu-a">Ï†ÑÏ≤¥ Í∏Ä</a>
                </li>
                <li class="menu-li">
                    <a class="menu-a">Ïπ¥ÌÖåÍ≥†Î¶¨</a>
                </li>
                <li class="menu-li">
                    <a class="menu-a">ÎÇ¥ Ï±ÑÌåÖ</a>
                </li>
            </ul>

        </div>
        <!-- ÌîÑÎ°úÌïÑ -->

    </div>

    <!-- Í≤åÏãúÌåê ÌãÄ DBÏóê ÏûàÎäî Î™®ÏßëÍ∏Ä Îç∞Ïù¥ÌÑ∞Î•º Ï°∞ÌöåÌï¥ÏÑú Î™®ÏßëÍ∏Ä Ï∂úÎ†•-->
    <div class="ad">
        <a href="#">
            <img img="" src="https://buts.co.kr/thema/Buts/colorset/Basic/img/guide_main_banner.png" alt="" title=""
                 class="ad-img">
        </a>
    </div>
    <div class="search-list">
        <input id="search_btn" type="button" value="ÌÉúÍ∑∏ Îì§Ïñ¥Í∞ÄÏïºÌï®."></input>
    </div>
    <div class="board-list">
        <th:block th:each="post : ${postList}">
            <div class="board" style="position: absolute; left: 0%; top: 0px;">
                <img class="board-img" src="images\chicken.png">
                <div class="boards">
                    <div class="board-header">
                        <div class="board-time" th:text="${#temporals.format(post.create_Date, 'HH:mm')}"></div>
                        <img class="board-link" src="images\link.png" href="#enterRoomModal" data-bs-toggle="modal"
                             data-target="#enterRoomModal" th:data-id="${post.id}" th:data-nickname="${nickname}"
                             onclick="backdropDelete()">
                    </div>
                    <div class="board-nickname" th:text="${post.nickname}"></div>
                    <div class="board-title" th:text="${post.title}"><a href="#"></a></div>
                    <div class="board-button" href="#enterRoomModal" data-bs-toggle="modal"
                         data-target="#enterRoomModal" th:data-id="${post.id}" th:data-nickname="${nickname}"
                         onclick="backdropDelete()"></a>
                        <button class="join">Go GO~</button>
                    </div>
                    <div class="board-categories" th:text="${post.categories}"></div>
                    <div class="board-peoples" th:text="${post.usercount} + '/' +${post.peoples}"></div>
                    <!--            <div class="food" th:text="${post.categories}"></div>-->
                </div>
            </div>
        </th:block>

    </div>
</div>



<!-- Î™®ÏßëÍ∏Ä ÏÉùÏÑ± -->
<div class="make-content">
    <button type="button" class="createOpen" id="createOpen">Î™®ÏßëÍ∏Ä ÏÉùÏÑ± üì£</button>
</div>

<section class="Register">
    <div class="modal" id="modal">
        <div class="popup" id="popup">
            <form action="/mozip" method="post">
                <div class="m_head">
                    <div class="modal_title">
                        <h1></h1>
                    </div>
                </div>
                <div class="m_body">
                    <div class="input-area">
                        <div class="body-titlebox">
                            <h2 class="mozip-h2">Î∞∞Í≥†Ìîà ÏÇ¨Îûå Î™®Ïó¨Îùº!</h2>
                        </div>
                        <div class="body-contentbox">
                            <div class="input-area">
                                <input type="text" name="title" id="title" autocomplete="off" required>
                                <label for="title">Ï†úÎ™©</label>
                            </div>

                            <div class="input-area">
                                <input type="number" name="distance_limit" id="distance_limit" autocomplete="off"
                                       required max="500">
                                <label for="distance_limit">Í∏Ä ÎÖ∏Ï∂ú Í±∞Î¶¨ Ï†úÌïú</label>
                            </div>
                            <div class="input-area">
                                <button class="add_store" id="add_store" type="button">Í∞ÄÍ≤åÏ∂îÍ∞Ä</button>
                            </div>

                            <div class="input-area">
                                <div class="sel">
                                    <select id="category" required>
                                        <option value="" disabled>Ïπ¥ÌÖåÍ≥†Î¶¨</option>
                                        <option value="ÏπòÌÇ®">ÏπòÌÇ®</option>
                                        <option value="ÌîºÏûê/ÏñëÏãù">ÌîºÏûê/ÏñëÏãù</option>
                                        <option value="Ï§ëÏãù">Ï§ëÏãù</option>
                                        <option value="ÌïúÏãù">ÌïúÏãù</option>
                                        <option value="ÏùºÏãù/ÎèàÍπåÏä§">ÏùºÏãù/ÎèàÍπåÏä§</option>
                                        <option value="Ï°±Î∞ú/Î≥¥Ïåà">Ï°±Î∞ú/Î≥¥Ïåà</option>
                                        <option value="Í≥†Í∏∞">Í≥†Í∏∞</option>
                                        <option value="Î∂ÑÏãù">Î∂ÑÏãù</option>
                                        <option value="Ïπ¥Ìéò/ÎîîÏ†ÄÌä∏">Ïπ¥Ìéò/ÎîîÏ†ÄÌä∏</option>
                                        <option value="ÏïÑÏãúÏïà">ÏïÑÏãúÏïà</option>
                                        <option value="ÏÉåÎìúÏúÑÏπò">ÏÉåÎìúÏúÑÏπò</option>
                                        <option value="ÏÖÄÎü¨Îìú">ÏÖÄÎü¨Îìú</option>
                                        <option value="ÎèÑÏãúÎùΩ/Ï£Ω">ÎèÑÏãúÎùΩ/Ï£Ω</option>
                                    </select>
                                </div>
                            </div>

                            <div class="input-area">
                                <div class="sel people">
                                    <select id="people" required>
                                        <option value="" disabled>Ïù∏Ïõê Ïàò</option>
                                        <option value="2">2Î™Ö</option>
                                        <option value="3">3Î™Ö</option>
                                        <option value="4">4Î™Ö</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="m_footer">
                    <button class="pop-btn create" id="create" type="submit">Í∏Ä ÏÉùÏÑ±</button>
                    <span class="pop-btn close" id="close">Ï∞Ω Îã´Í∏∞</span>
                </div>
            </form>
        </div>
    </div>
</section>

<!-- Î™®ÏßëÍ∏Ä ÌÅ¥Î¶≠Ïãú Î™®Îã¨Ï∞Ω Î≥¥Ïó¨Ï§å -->
<div class="modal fade" id="enterRoomModal" tabindex="-1" aria-labelledby="enterRoomModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <img class="join-img" src="images/join.png">
                <p class="join-icon">üí°</p>
                <p class="join-p">ÏûÖÏû• ÌïòÏãúÍ≤†ÏäµÎãàÍπå?</p>
            </div>
            <div class="modal-footer">
                <input class="btn btn-access" id="join_btn" type="button" value="ÏûÖÏû•" data-bs-dismiss="modal"
                       onclick="enterRoom()">
                <input class="btn btn-back" id="modal_close_btn" type="button" data-bs-dismiss="modal" value="Ï∑®ÏÜå">
            </div>
        </div>
    </div>
</div>
<!-- Í∞ÄÍ≤åÏÑ†ÌÉù Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú Í∞ÄÍ≤å Î¶¨Ïä§Ìä∏ Î™®Îã¨Ï∞Ω Î≥¥Ïó¨Ï§å -->
<div class="storeModal">
    <div class="storeModal_content">
        <div class="storeModal_header">
            <input id="search_store" type="text">
            </input>
            <button id="search_store_btn" type="button">Í≤ÄÏÉâ
            </button>
        </div>
        <!-- ---------------------------------------- -->
        <div class="storeModal_body">

        </div>
        <!-- -------------------------------------------- -->
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<script th:inline="javascript">


        function DaumPostcode() {
            new daum.Postcode({
                oncomplete: function (data) {
                    document.getElementById('address_input').value = data.address;
                }
            }).open();
        }

        document.getElementById("create").addEventListener("click", function () {
            var selectedValue1 = document.getElementById("category").value; // select optionÏóêÏÑú ÏÑ†ÌÉùÎêú Í∞í Í∞ÄÏ†∏Ïò§Í∏∞
            var selectedValue2 = document.getElementById("people").value; // select optionÏóêÏÑú ÏÑ†ÌÉùÎêú Í∞í Í∞ÄÏ†∏Ïò§Í∏∞
            $.ajax({
                type: "POST", // Ï†ÑÏÜ° Î∞©Ïãù
                url: "/mozipCreate", // Ïª®Ìä∏Î°§Îü¨ URL
                data: {
                    selectedValue1: selectedValue1,
                    selectedValue2: selectedValue2
                }, // Ï†ÑÎã¨Ìï† Îç∞Ïù¥ÌÑ∞
                success: function (result) {
                    $("#changeInput").val('ÏÑ±Í≥µ');
                },
                error: function (xhr, status, error) {
                    $("#changeInput").val('Ïã§Ìå®');
                }
            });
        });

        let id;



        function backdropDelete() {
            // $('.modal-backdrop').remove();
        }

        var myModal = new bootstrap.Modal(document.getElementById('enterRoomModal'), {
            backdropDelete: true
        });
        $(function () {

            $("#enterRoomModal").on("show.bs.modal", function (event) {
                id = $(event.relatedTarget).data('id');
                nickname = $(event.relatedTarget).data('nickname');
            });

        })


        function chkRoomUserCnt(id, nickname) {
            let chk;

            $.ajax({
                type: "GET",
                url: "/mozip/chat/chkRoomUserCnt",
                data: {
                    id: id,
                    nickname: nickname
                },
                async: false,
                success: function (result) {
                    if (!result) {
                        alert("Ï±ÑÌÉïÎ∞©Ïù¥ ÍΩâ Ï∞ºÎã§!");
                    }
                    chk = result;
                },
                error: function () {
                    alert("Ïã§Ìå®!");
                }
            })
            return chk;
        }



        function enterRoom() {
            if (chkRoomUserCnt(id, nickname)) {
                location.href = "/mozip/chat/room?id=" + id;
            }
        }
    </script>
<script src="/js/main_page.js"></script>
<script src="/js/addStore.js"></script>

</body>

</html>